<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>WebGPU-SGEMM</title>
  <meta http-equiv="origin-trial" content="AnMX2q5uw5+YXJHEw/cFGM1gyU2ge081087sXMOsAVqq1QZNZ61TXbqHNbUEAw/OgyFUpRBKHx4irhgJOV28tgQAAABTeyJvcmlnaW4iOiJodHRwczovL21pbGhpZGFrYS5naXRodWIuaW86NDQzIiwiZmVhdHVyZSI6IldlYkdQVSIsImV4cGlyeSI6MTY5MTcxMTk5OX0=">
  <script type="module" src="/src/main.ts"></script>

</head>

<body>
  <h1>WebGPU-SGEMM</h1>
  <p>This project computes matrix-matrix multiplication (sgemm) using <a
      href="https://gpuweb.github.io/gpuweb/">WebGPU</a>.</p>
  <p>WebGPU state in this browser: <span id="is_webgpu_enabled" style="color: red;"></span></p>


  <div>
    <h2>Small example</h2>
    <p>Computes</p>
    <pre>[1,2
 3,4]
Ã—
[5,6
 7,8]</pre>
    <button type="button" id="small_example">Compute</button>
    <pre id="small_example_result"></pre>
  </div>
  <div>
    <h2>Test</h2>
    <p>Compares computation result of WebGPU and pure JavaScript implementation.</p>
    <textarea id="test_shapes" cols="20" rows="10">1,1,1
32,32,32
10,20,30
32,64,4
32,33,34
64,64,64
65,67,69</textarea>
    <button type="button" id="run_test">Run</button>
    <pre id="test_message"></pre>
  </div>
  <div>
    <h2>Benchmark</h2>
    <p>Note: when m % 32 === 0 && n % 64 === 0 && k % 4 === 0, efficient kernel is used.</p>
    M,N,K tuples:<br />
    <textarea id="benchmark_shapes" cols="23" rows="10">32,32,32
64,64,64
128,128,128
256,256,256
512,512,512
1024,1024,1024
2048,2048,2048
4096,4096, 4096</textarea>
    <button type="button" id="run_benchmark">Benchmark</button>
    <pre id="bench_message"></pre>
  </div>


  <div id="plotContainer" style="margin-top: 20px;">
  <h3>Performance Results</h3>
  <canvas id="benchmarkPlot" width="800" height="500" style="border: 1px solid #ddd; background: white;"></canvas>
  <button onclick="plotBenchmarkResults()" style="margin-top: 10px; padding: 5px 15px;">Refresh Plot</button>
</div>


</body>

</html>